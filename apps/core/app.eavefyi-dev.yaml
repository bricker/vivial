runtime: python311
service: api

entrypoint: |-
  gunicorn \
    --bind :$PORT \
    --pythonpath vendor \
    --workers 3 \
    --worker-class uvicorn.workers.UvicornWorker \
    eave.core.app:app

handlers:
- url: /_ah/.*
  login: admin
  script: auto
  auth_fail_action: unauthorized

- url: .*
  script: auto

inbound_services:
- warmup

instance_class: B2
basic_scaling:
  max_instances: 2

vpc_access_connector:
  name: projects/eavefyi-dev/locations/us-central1/connectors/appengine

env_variables:
  EAVE_APPS_BASE: https://apps.eave.dev
  EAVE_API_BASE: https://api.eave.dev
  EAVE_WWW_BASE: https://www.eave.dev
  EAVE_ANALYTICS_ENABLED: "1"
  EAVE_MONITORING_ENABLED: "1"
  LOG_LEVEL: "DEBUG"
  REDIS_CONNECTION: "10.223.96.43:6378:0"
  REDIS_TLS_CA: |-
    -----BEGIN CERTIFICATE-----
    MIIDnTCCAoWgAwIBAgIBADANBgkqhkiG9w0BAQsFADCBhTEtMCsGA1UELhMkYmRl
    OTczYjItOTc3YS00YTM0LWFmYzUtOWFkZDM1YjExMzAxMTEwLwYDVQQDEyhHb29n
    bGUgQ2xvdWQgTWVtb3J5c3RvcmUgUmVkaXMgU2VydmVyIENBMRQwEgYDVQQKEwtH
    b29nbGUsIEluYzELMAkGA1UEBhMCVVMwHhcNMjMwNjIwMDEyMzQ0WhcNMzMwNjE3
    MDEyNDQ0WjCBhTEtMCsGA1UELhMkYmRlOTczYjItOTc3YS00YTM0LWFmYzUtOWFk
    ZDM1YjExMzAxMTEwLwYDVQQDEyhHb29nbGUgQ2xvdWQgTWVtb3J5c3RvcmUgUmVk
    aXMgU2VydmVyIENBMRQwEgYDVQQKEwtHb29nbGUsIEluYzELMAkGA1UEBhMCVVMw
    ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCYolpDHRkpkKmuu/HOwuUX
    wVjAgXf94Y53StkfRfZmTIkIvhtwyw3Eq7/j/4QbmMpQMvzulO5kG/mGJWOzHIwD
    MUd2L1N91r4qEd/4H879dOkjKoxHvi2Jwavck0OvLrzz6gnFIKMLmnIw8jl2TPWq
    53druYH6aYJBbgW/rN9OZyms9w8A0adhmUZ1mzAOaadr/1nuHqtoTCMw1x9UJfeO
    SPAtYdu0xiuthaceZVYaGhyEri0BvR2ZXOFLNxWcJFPZDIgoOi0rDAL61wh3ujml
    NDPmROoCY+1k71IYGaiIfi+YUlEpzGpQvpQkZg3oXjoRx/WpKgAzRWTTkTp/E2K7
    AgMBAAGjFjAUMBIGA1UdEwEB/wQIMAYBAf8CAQAwDQYJKoZIhvcNAQELBQADggEB
    ADmRj01P5giXb/a98J8niHaWNdDLovbrO88bFC6/q6YspEYMNIH0q0q+ksnkZ0C1
    ywcauBmOLnt1ODuk0AyerdtDpkiDuM8bdVK/r0Eo4AL5OaawaOC5xbql4bnLBt9x
    3NOwf6ItbqLqBlSI/9pLar2wUkDLlmht8TR43/1FAGTyWohTd+iXyR9QG0eOXCzC
    nEcDsFHauZazweobvZwzHbrGQM2KKd90t2yrWA+IiH0Vpv9jJou13K64cJjtKfgb
    9cpSu8/Ci75oyqc5FR1pA/eOIyCInM0T2D/+/bv7mYgpbDAzjKyZCSp2drkhBGBL
    pvZVC9SZdR7mn0cLeKsXxGo=
    -----END CERTIFICATE-----
